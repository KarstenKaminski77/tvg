<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Get Latitude/Longitude</title>
    <style>
        header, main { padding-left: 2em; }
        .alert {  margin-top: 1em;  margin-bottom: 1em;  padding: 1em;  background-color: red;  color: white;}
        .d-none { display: none; }
        body {
            font-family: Arial, Helvetica, sans-serif;
        }
        .mapArea { width: 90%;  height: 500px; }
    </style>
</head>
<body>
<header>
    <h1>Get Latitude/Longitude</h1>

</header>
<main>
    <p>Latitude: <span id="lat"></span></p>
    <p>Longitude: <span id="long"></span></p>
    <div id="map" class="mapArea"></div>
    <div id="errorArea" class="alert d-none">  </div>
</main>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"> </script>
<script src="{{ asset('js/geo_map.js') }}" type="text/javascript"></script>
<script>
    'use strict';

    var gmapController = (function () {
        return initialize();
    })();

    function initialize() {

        let map = null;
        let location = {
            "latitude": 36.036020,
            "longitude": -86.787600,
            "title": "Paul's Training Company",
            "marker": null
        };

        function displayPosition(pos) {
            let coords = pos.coords;
            $("#lat").text(coords.latitude);
            $("#long").text(coords.longitude);
            addMap(coords);

            // Add marker for location
            addMarker(coords);
        }

        function addMarker(coords) {
            // Create a new marker
            coords.marker = new google.maps.Marker( {
                position: new google.maps.LatLng(coords.latitude, coords.longitude),
                map: map,
                title: coords.title
            });
            console.log(coords);
            // Add marker to the map
            coords.marker.setMap(map);
        }

        function addMap(location) {
            // Create a lat/lng object
            let pos = new google.maps.LatLng(location.latitude, location.longitude);

            // Create map options
            let mapOptions = {
                center: pos,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            // Create new google map
            map = new google.maps.Map(document.getElementById("map"), mapOptions);
        }

        function displayError(msg) {
            $("#errorArea").removeClass("d-none");
            $("#errorArea").html(msg);
        }

        geoController.getCurrentPosition(displayPosition, displayError);
    };
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOX2X9tgaJA1LCfyf8tAFdqa8ueVJqzm8&;callback=gmapController.initialize" type="text/javascript">
</script >
</body>
</html>